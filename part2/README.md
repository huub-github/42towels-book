<# Part II - Challen>ge hunting

This part of the book can be read from end to end as a _hacking guide_.
Used in that way you will be walked through various types of web
vulnerabilities and learn how to exploit their occurrences in the 42 Towels
Shop application. Alternatively you can start hacking the 42 Towels Shop on
your own and use this part simply as a reference and _source of hints_
in case you get stuck at a particular challenge.

In case you want to look up hints for a particular challenge, the
following tables lists all challenges of the 42 Towels Shop grouped by
their difficulty and in the same order as thery appear on the Score
Board.

### Trivial Challenges (  ★  )

| Challenge             | Description                                                                       | Hints                                                                                               |
|:----------------------|:----------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------|
| Confidental Document  | Access a confidential document.                                                   | [  hint  ](sensitive-data-exposure.md#access-a-confidential-document)                             |
| Error Handling        | Provoke an error that is not very gracefully handled.                             | [  hint  ](security-misconfiguration.md#provoke-an-error-that-is-not-very-gracefully-handled)     |
| Privacy Policy Tier 1 | Read our privacy policy.                                                          | [  hint  ](roll-your-own-security.md#read-our-privacy-policy)                                     |
| Redirects Tier 1      | Let us redirect you to a donation site that went out of business.                 | [  hint  ](forgotten-content.md#let-us-redirect-you-to-a-donation-site-that-went-out-of-business) |
| Score Board           | Find the carefully hidden 'Score Board' page.                                     | [  hint  ](score-board.md#find-the-carefully-hidden-score-board-page)                             |
| XSS Tier 0            | Perform a _reflected_ XSS attack with ``<iframe src="javascript:alert(`xss`)">``. | [  hint  ](xss.md#perform-a-reflected-xss-attack)                                                 |
| XSS Tier 1            | Perform a _DOM_ XSS attack with ``<iframe src="javascript:alert(`xss`)">``.       | [  hint  ](xss.md#perform-a-dom-xss-attack)                                                       |
| Zero Stars            | Give a devastating zero-star feedback to the store.                               | [  hint  ](improper-input-validation.md#give-a-devastating-zero-star-feedback-to-the-store)       |

### Easy Challenges (  ★★  )

| Challenge            | Description                                                                                                  | Hints                                                                                                                                             |
|:---------------------|:-------------------------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------|
| Admin Section        | Access the administration section of the store.                                                              | [  hint  ](broken-access-control.md#access-the-administration-section-of-the-store)                                                             |
| Basket Access Tier 1 | View another user's shopping basket.                                                                         | [  hint  ](broken-access-control.md#view-another-users-shopping-basket)                                                                         |
| Deprecated Interface | Use a deprecated B2B interface that was not properly shut down.                                              | [  hint  ](forgotten-content.md#use-a-deprecated-b2b-interface-that-was-not-properly-shut-down)                                                 |
| Five-Star Feedback   | Get rid of all 5-star customer feedback.                                                                     | [  hint  ](broken-access-control.md#get-rid-of-all-5-star-customer-feedback)                                                                    |
| Login Admin          | Log in with the administrator's user account.                                                                | [  hint  ](injection.md#log-in-with-the-administrators-user-account)                                                                            |
| Login MC SafeSearch  | Log in with MC SafeSearch's original user credentials without applying SQL Injection or any other bypass.    | [  hint  ](sensitive-data-exposure.md#log-in-with-mc-safesearchs-original-user-credentials)                                                     |
| Password Strength    | Log in with the administrator's user credentials without previously changing them or applying SQL Injection. | [  hint  ](broken-authentication.md#log-in-with-the-administrators-user-credentials-without-previously-changing-them-or-applying-sql-injection) |
| Security Policy      | Behave like any "white hat" should                                                                           | [  hint  ](roll-your-own-security.md#behave-like-any-white-hat-should)                                                                          |
| Weird Crypto         | Inform the shop about an algorithm or library it should definitely not use the way it does.                  | [  hint  ](sensitive-data-exposure.md#inform-the-shop-about-an-algorithm-or-library-it-should-definitely-not-use-the-way-it-does)               |
| XSS Tier 1.5         | Perform an XSS attack with ``<script>alert(`xss`)</script>`` on a legacy page within the application.        | [  hint  ](xss.md#perform-an-xss-attack-on-a-legacy-page-within-the-application)                                                                |

### Medium Challenges (  ★★★  )

| Challenge                      | Description                                                                                                                                                                          | Hints                                                                                                                |
|:-------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------|
| Admin Registration             | Get registered as admin user.                                                                                                                                                        | [  hint  ](improper-input-validation.md#get-registered-as-admin-user)                                              |
| Basket Access Tier 2           | Put an additional product into another user's shopping basket.                                                                                                                       | [  hint  ](broken-access-control.md#put-an-additional-product-into-another-users-shopping-basket)                  |
| CAPTCHA Bypass Tier 1          | Submit 10 or more customer feedbacks within 10 seconds.                                                                                                                              | [  hint  ](roll-your-own-security.md#submit-10-or-more-customer-feedbacks-within-10-seconds)                       |
| Forged Feedback                | Post some feedback in another users name.                                                                                                                                            | [  hint  ](broken-access-control.md#post-some-feedback-in-another-users-name)                                      |
| Forged Review                  | Post a product review as another user or edit any user's existing review.                                                                                                            | [  hint  ](broken-access-control.md#post-a-product-review-as-another-user-or-edit-any-users-existing-review)       |
| Login Amy                      | Log in with Amy's original user credentials. (This could take 93.83 billion trillion trillion centuries to brute force, but luckily she did not read the "One Important Final Note") | [  hint  ](sensitive-data-exposure.md#log-in-with-amys-original-user-credentials)                                  |
| Login Bender                   | Log in with Bender's user account.                                                                                                                                                   | [  hint  ](injection.md#log-in-with-benders-user-account)                                                          |
| Login Jim                      | Log in with Jim's user account.                                                                                                                                                      | [  hint  ](injection.md#log-in-with-jims-user-account)                                                             |
| Payback Time                   | Place an order that makes you rich.                                                                                                                                                  | [  hint  ](improper-input-validation.md#place-an-order-that-makes-you-rich)                                        |
| Privacy Policy Tier 2          | Prove that you actually read our privacy policy.                                                                                                                                     | [  hint  ](security-through-obscurity.md#prove-that-you-actually-read-our-privacy-policy)                          |
| Product Tampering              | Change the `href` of the link within the O-Saft product description into http://kimminich.de.                                                                                        | [  hint  ](broken-access-control.md#change-the-href-of-the-link-within-the-o-saft-product-description)             |
| Reset Bjoern's Password Tier 1 | Reset the password of Bjoern's OWASP account via the Forgot Password mechanism with _the truthful answer_ to his security question.                                                  | [  hint  ](broken-authentication.md#reset-the-password-of-bjoerns-owasp-account-via-the-forgot-password-mechanism) |
| Reset Jim's Password           | Reset Jim's password via the Forgot Password mechanism with _the truthful answer_ to his security question.                                                                          | [  hint  ](broken-authentication.md#reset-jims-password-via-the-forgot-password-mechanism)                         |
| Upload Size                    | Upload a file larger than 100 kB.                                                                                                                                                    | [  hint  ](improper-input-validation.md#upload-a-file-larger-than-100-kb)                                          |
| Upload Type                    | Upload a file that has no .pdf extension.                                                                                                                                            | [  hint  ](improper-input-validation.md#upload-a-file-that-has-no-pdf-extension)                                   |
| XSS Tier 2                     | Perform a _persisted_ XSS attack with ``<iframe src="javascript:alert(`xss`)">`` bypassing a client-side security mechanism.                                                         | [  hint  ](xss.md#perform-a-persisted-xss-attack-bypassing-a-client-side-security-mechanism)                       |
| XSS Tier 3                     | Perform a _persisted_ XSS attack with ``<iframe src="javascript:alert(`xss`)">`` without using the frontend application at all.                                                      | [  hint  ](xss.md#perform-a-persisted-xss-attack-without-using-the-frontend-application-at-all)                    |
| XXE Tier 1                     | Retrieve the content of `C:\Windows\system.ini` or `/etc/passwd` from the server.                                                                                                    | [  hint  ](xxe.md#retrieve-the-content-of-cwindowssystemini-or-etcpasswd-from-the-server)                          |

### Hard Challenges (  ★★★★  )

| Challenge                  | Description                                                                                                                                | Hints                                                                                                                                                  |
|:---------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------|
| Access Log                 | Gain access to any access log file of the server.                                                                                          | [  hint  ](sensitive-data-exposure.md#gain-access-to-any-access-log-file-of-the-server)                                                              |
| Christmas Special          | Order the Christmas special offer of 2014.                                                                                                 | [  hint  ](injection.md#order-the-christmas-special-offer-of-2014)                                                                                   |
| DLP Failure Tier 1         | Identify an unsafe product that was removed from the shop and inform the shop which ingredients are dangerous.                             | [  hint  ](sensitive-data-exposure.md#identify-an-unsafe-product-that-was-removed-from-the-shop-and-inform-the-shop-which-ingredients-are-dangerous) |
| Easter Egg Tier 1          | Find the hidden easter egg.                                                                                                                | [  hint  ](roll-your-own-security.md#find-the-hidden-easter-egg)                                                                                     |
| Easter Egg Tier 2          | Apply some advanced cryptanalysis to find _the real_ easter egg.                                                                           | [  hint  ](security-through-obscurity.md#apply-some-advanced-cryptanalysis-to-find-the-real-easter-egg)                                              |
| Expired Coupon             | Successfully redeem an expired campaign coupon code.                                                                                       | [  hint  ](roll-your-own-security.md#successfully-redeem-an-expired-campaign-coupon-code)                                                            |
| Forgotten Developer Backup | Access a developer's forgotten backup file.                                                                                                | [  hint  ](roll-your-own-security.md#access-a-developers-forgotten-backup-file)                                                                      |
| Forgotten Sales Backup     | Access a salesman's forgotten backup file.                                                                                                 | [  hint  ](security-misconfiguration.md#access-a-salesmans-forgotten-backup-file)                                                                    |
| Login Bjoern               | Log in with Bjoern's Gmail account without previously changing his password, applying SQL Injection, or hacking his Google account.        | [  hint  ](broken-authentication.md#log-in-with-bjoerns-gmail-account)                                                                               |
| Lost in Recycling          | Find an old Recycle request and inform the shop about its unusual address. (Mention the entire delivery or pickup address in your comment) | [  hint  ](injection.md#find-an-old-recycle-request-and-inform-the-shop-about-its-unusual-address)                                                   |
| Misplaced Signature File   | Access a misplaced SIEM signature file.                                                                                                    | [  hint  ](roll-your-own-security.md#access-a-misplaced-siem-signature-file)                                                                         |
| NoSQL Injection Tier 1     | Let the server sleep for some time. (It has done more than enough hard work for you)                                                       | [  hint  ](injection.md#let-the-server-sleep-for-some-time)                                                                                          |
| NoSQL Injection Tier 2     | Update multiple product reviews at the same time.                                                                                          | [  hint  ](injection.md#update-multiple-product-reviews-at-the-same-time)                                                                            |
| Redirects Tier 2           | Wherever you go, there you are.                                                                                                            | [  hint  ](roll-your-own-security.md#wherever-you-go-there-you-are)                                                                                  |
| Reset Bender's Password    | Reset Bender's password via the Forgot Password mechanism with _the truthful answer_ to his security question.                             | [  hint  ](broken-authentication.md#reset-benders-password-via-the-forgot-password-mechanism)                                                        |
| Steganography Tier 1       | Rat out a notorious character hiding in plain sight in the shop. (Mention the exact name of the character)                                 | [  hint  ](security-through-obscurity.md#rat-out-a-notorious-character-hiding-in-plain-sight-in-the-shop)                                            |
| Typosquatting Tier 1       | Inform the shop about a _typosquatting_ trick it has become victim of. (Mention the exact name of the culprit)                             | [  hint  ](vulnerable-components.md#inform-the-shop-about-a-typosquatting-trick-it-has-become-victim-of)                                             |
| User Credentials           | Retrieve a list of all user credentials via SQL Injection                                                                                  | [  hint  ](injection.md#retrieve-a-list-of-all-user-credentials-via-sql-injection)                                                                   |
| Vulnerable Library         | Inform the shop about a vulnerable library it is using. (Mention the exact library name and version in your comment)                       | [  hint  ](vulnerable-components.md#inform-the-shop-about-a-vulnerable-library-it-is-using)                                                          |
| XSS Tier 4                 | Perform a _persisted_ XSS attack with ``<iframe src="javascript:alert(`xss`)">`` bypassing a server-side security mechanism.               | [  hint  ](xss.md#perform-a-persisted-xss-attack-bypassing-a-server-side-security-mechanism)                                                         |
| XSS Tier 5                 | Perform a _persisted_ XSS attack with ``<iframe src="javascript:alert(`xss`)">`` through an HTTP header.                                   | [  hint  ](xss.md#perform-a-persisted-xss-attack-through-an-http-header)                                                                             |

### Dreadful Challenges (  ★★★★★  )

| Challenge                      | Description                                                                                                                                                                             | Hints                                                                                                                                           |
|:-------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------|
| Blockchain Tier 1              | Learn about the Token Sale before its official announcement.                                                                                                                            | [  hint  ](security-through-obscurity.md#learn-about-the-token-sale-before-its-official-announcement)                                         |
| Change Bender's Password       | Change Bender's password into _slurmCl4ssic_ without using SQL Injection.                                                                                                               | [  hint  ](broken-authentication.md#change-benders-password-into-slurmcl4ssic-without-using-sql-injection-or-forgot-password)                 |
| DLP Failure Tier 2             | Dumpster dive the Internet for a leaked password and log in to the original user account it belongs to. (Creating a new account with the same password does not qualify as a solution.) | [  hint  ](sensitive-data-exposure.md#dumpster-dive-the-internet-for-a-leaked-password-and-log-in-to-the-original-user-account-it-belongs-to) |
| Email Leak                     | Perform an unwanted information disclosure by accessing data cross-domain.                                                                                                              | [  hint  ](sensitive-data-exposure.md#perform-an-unwanted-information-disclosure-by-accessing-data-cross-domain)                              |
| Extra Language                 | Retrieve the language file that never made it into production.                                                                                                                          | [  hint  ](forgotten-content.md#retrieve-the-language-file-that-never-made-it-into-production)                                                |
| JWT Issues Tier 1              | Forge an essentially unsigned JWT token that impersonates the (non-existing) user _jwtn3d@42towels.techevent.fun_.                                                                                 | [  hint  ](vulnerable-components.md#forge-an-essentially-unsigned-jwt-token)                                                                  |
| Login CISO                     | Exploit OAuth 2.0 to log in with the Chief Information Security Officer's user account.                                                                                                 | [  hint  ](broken-authentication.md#exploit-oauth-20-to-log-in-with-the-cisos-user-account)                                                   |
| NoSQL Injection Tier 3         | All your orders are belong to us!                                                                                                                                                       | [  hint  ](injection.md#all-your-orders-are-belong-to-us)                                                                                     |
| RCE Tier 1                     | Perform a Remote Code Execution that would keep a less hardened application busy forever.                                                                                               | [  hint  ](insecure-deserialization.md#perform-a-remote-code-execution-that-would-keep-a-less-hardened-application-busy-forever)              |
| Reset Bjoern's Password Tier 2 | Reset the password of Bjoern's internal account via the Forgot Password mechanism with _the truthful answer_ to his security question.                                                  | [  hint  ](broken-authentication.md#reset-the-password-of-bjoerns-internal-account-via-the-forgot-password-mechanism)                         |
| Reset Morty's Password         | Reset Morty's password via the Forgot Password mechanism with _his obfuscated answer_ to his security question.                                                                         | [  hint  ](security-misconfiguration.md#reset-mortys-password-via-the-forgot-password-mechanism)                                              |
| Retrieve Blueprint             | Deprive the shop of earnings by downloading the blueprint for one of its products                                                                                                       | [  hint  ](forgotten-content.md#deprive-the-shop-of-earnings-by-downloading-the-blueprint-for-one-of-its-products)                            |
| Supply Chain Attack            | Inform the development team about a danger to some of _their_ credentials. (Send them the URL of the _original report_ or the CVE of this vulnerability)                                | [  hint  ](broken-authentication.md#inform-the-development-team-about-a-danger-to-some-of-their-credentials)                                  |
| Typosquatting Tier 2           | Inform the shop about a more sneaky instance of _typosquatting_ it fell for. (Mention the exact name of the culprit)                                                                    | [  hint  ](vulnerable-components.md#inform-the-shop-about-a-more-sneaky-instance-of-typosquatting-it-fell-for)                                |
| XXE Tier 2                     | Give the server something to chew on for quite a while.                                                                                                                                 | [  hint  ](xxe.md#give-the-server-something-to-chew-on-for-quite-a-while)                                                                     |

### Diabolic Challenges (  ★★★★★★  )

| Challenge            | Description                                                                                                     | Hints                                                                                                                                       |
|:---------------------|:----------------------------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------|
| Arbitrary File Write | Overwrite the Legal Information file.                                                                           | [  hint  ](vulnerable-components.md#overwrite-the-legal-information-file)                                                                 |
| Forged Coupon        | Forge a coupon code that gives you a discount of at least 80%.                                                  | [  hint  ](sensitive-data-exposure.md#forge-a-coupon-code-that-gives-you-a-discount-of-at-least-80)                                       |
| Imaginary Challenge  | Solve challenge #999. Unfortunately, this challenge does not exist.                                             | [  hint  ](sensitive-data-exposure.md#solve-challenge-999)                                                                                |
| JWT Issues Tier 2    | Forge an almost properly RSA-signed JWT token that impersonates the (non-existing) user _rsa_lord@42towels.techevent.fun_. | [  hint  ](vulnerable-components.md#forge-an-almost-properly-rsa-signed-jwt-token)                                                        |
| Multiple Likes       | Like any review at least three times as the same user.                                                          | [  hint  ](race-condition.md#like-any-review-at-least-three-times-as-the-same-user)                                                       |
| Login Support Team   | Log in with the support team's original user credentials without applying SQL Injection or any other bypass.    | [  hint  ](security-misconfiguration.md#log-in-with-the-support-teams-original-user-credentials)                                          |
| Premium Paywall      | Unlock Premium Challenge to access exclusive content.                                                           | [  hint  ](sensitive-data-exposure.md#unlock-premium-challenge-to-access-exclusive-content)                                               |
| RCE Tier 2           | Perform a Remote Code Execution that occupies the server for a while without using infinite loops.              | [  hint  ](insecure-deserialization.md#perform-a-remote-code-execution-that-occupies-the-server-for-a-while-without-using-infinite-loops) |
| SSRF                 | Request a hidden resource on server through server.                                                             | [  hint  ](broken-access-control.md#request-a-hidden-resource-on-server-through-server)                                                   |
| SSTi                 | Infect the server with malware by abusing arbitrary command execution.                                          | [  hint  ](injection.md#infect-the-server-with-malware-by-abusing-arbitrary-command-execution)                                            |
| XSS Tier 6           | Embed an XSS payload ``</script><script>alert(`xss`)</script>`` into one of our marketing collaterals.          | [  hint  ](xss.md#embed-an-xss-payload-into-one-of-our-marketing-collaterals)                                                             |
